{% extends "base.html" %}

{% block head_extras %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/book_create.css') }}">
<link rel="stylesheet" href="../static/css/book_create.css">
{% endblock %}

{% block title %}Book -- Create{% endblock %}

{% block content %}
{% include "includes/flash.html" %}
	<div class="book-create">
		<h1 class="book-create__h1">CREATE A BOOK</h1>
		<form action="" method="POST">
			<div class="book-create__bio">
				<h3 class="book-create__h3">Bio</h3>
					<ul class="book-create__ul">
						<li class="book-create__ul__li"><label for="title">Title</label>: <input type="text" name="title" class="book-create__input" placeholder="Book Title"></li>
						<li class="book-create__ul__li"><label for="cover">Cover</label>: <input type="text" name="cover" class="book-create__input" placeholder="Cover Image URL"></li>
						<li class="book-create__ul__li"><label for="description">Description</label>: <textarea name="description" id="" class="book-create__textarea" rows="5" placeholder="Book Description"></textarea></li>
					</ul>
			</div>
			<div class="book-create__authors">
				<h3 class="book-create__h3">Authors</h3>
				<button class="book-create__button book-create__button--add" id="add_author">ADD</button>
				<ul class="book-create__ul ul_author">
					<li id="book_author" class="book-create__ul__li">
						<select name="author" id="" class="book-create__select">
						<option value="">Select an author</option>
						{% for author in authors %}
							<option value="{{ author.id }}">{% if author.first_name %}{{ author.first_name }} {% endif %}{{ author.last_name }}</option>
						{% endfor %}
						</select>
					</li>
				</ul>
			</div>
			<div class="book-create__genres">
				<h3 class="book-create__h3">Genres</h3>
				<button class="book-create__button book-create__button--add" id="add_genre">ADD</button>
				<ul class="book-create__ul ul_genre">
					<li id="book_genre" class="book-create__ul__li">
						<select name="genre" id="" class="book-create__select">
						<option value="">Select a genre</option>
						{% for genre in genres %}
							<option value="{{ genre.id }}">{{ genre.type }}</option>
						{% endfor %}
						</select>
					</li>
				</ul>
			</div>
			<button class="button button--cancel"><a href="{{ url_for('catalog_books') }}">Cancel</a></button>
			<input class="button button--send" type="submit" value="Create">
		</form>
	</div>
	<script>
		let book_genre = document.querySelector("#book_genre");
		let add_genre = document.querySelector("#add_genre");

		add_genre.addEventListener("click", function(e){
			e.preventDefault();
			addLI(book_genre)
		});

		let book_author = document.querySelector("#book_author");
		let add_author = document.querySelector("#add_author");

		add_author.addEventListener("click", function(e){
			e.preventDefault();
			addLI(book_author)
		});

		function addLI(el) {
			let newLi = el.cloneNode(true);
			newLi.innerHTML += '<button class="book-create__button book-create__button--delete">X</button>'
			el.parentElement.appendChild(newLi);
		}

		document.addEventListener("click", function(e){
			if (event.target.classList.contains('book-create__button--delete')) {
				e.target.parentElement.parentElement.removeChild(e.target.parentElement);
				console.log("REMOVED " + e.target);
			}
		});
	</script>
{% endblock %}

<!-- Change .book_genre to #book_genre? and .book_author to #book_author? -->