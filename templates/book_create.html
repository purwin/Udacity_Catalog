{% extends "base.html" %}

{% block title %}Book -- Create{% endblock %}

{% block content %}
	<h1>CREATE A BOOK</h1>
	<form action="" method="POST">
		<ul>
			<li><label for="">Title</label>: <input type="text" name="title" placeholder="Book Title"></li>
			<li><label for="">Cover</label>: <input type="text" name="cover" placeholder="Cover Image URL"></li>
			<li><label for="">Description</label>: <input type="text" name="description" placeholder="Book Description"></li>
		</ul>
		<h3>Authors</h3>
		<span class="add" id="add_author">ADD</span>
		<ul class="ul_author">
			<li class="book_author">
				<select name="author" id="">
				<option value="">Select an author</option>
				{% for author in authors %}
					<option value="{{ author.id }}">{% if author.first_name %}{{ author.first_name }} {% endif %}{{ author.last_name }}</option>
				{% endfor %}
				</select>
			</li>
		</ul>
		<h3>Genres</h3>
		<span class="add" id="add_genre">ADD</span>
		<ul class="ul_genre">
			<li class="book_genre">
				<select name="genre" id="">
				<option value="">Select a genre</option>
				{% for genre in genres %}
					<option value="{{ genre.id }}">{{ genre.type }}</option>
				{% endfor %}
				</select>
			</li>
		</ul>
		<button><a href="{{ url_for('catalog_books') }}">Cancel</a></button>
		<input type="submit" value="Create">
	</form>
	<script>
		let book_genre = document.querySelector(".book_genre");
		let add_genre = document.querySelector("#add_genre");

		add_genre.addEventListener("click", function(){
			addLI(book_genre)
		});

		let book_author = document.querySelector(".book_author");
		let add_author = document.querySelector("#add_author");

		add_author.addEventListener("click", function(){
			addLI(book_author)
		});

		function addLI(el) {
			let newLi = el.cloneNode(true);
			newLi.innerHTML += '<span class="delete">X</span>'
			el.parentElement.appendChild(newLi);
		}

		document.addEventListener("click", function(e){
			if (event.target.classList.contains('delete')) {
				e.target.parentElement.parentElement.removeChild(e.target.parentElement);
			}
		});
	</script>
{% endblock %}